import java.util.Scanner;

public class Foothill
{
    public static void main(String[] args)
    {
        int rule_num = 0;
        int runs = 100;

        Scanner in = new Scanner(System.in); 
        while (rule_num != -1)         
          {
              System.out.print("\nEnter a rule (0-255): ");
              String choice = in.next();
              
              //checks that the input is an integer
              try
              {
                  rule_num = Integer.parseInt(choice);            
              }
              catch (Exception e)
              {
                  System.out.println("INVALID: Try Again");  
                  continue;
              }
              
              Automaton cellularAutomata = new Automaton(rule_num);
              for (int j = 0; j < runs; j++)
              {
                  System.out.println(cellularAutomata.toStringCurrentGen());                  
                  cellularAutomata.propagateNewGeneration();    
                  
              }
              System.out.println("ENTER -1 TO EXIT PROGRAM");  
               
          }
    }
}

class Automaton
{
    // class constants
    public final static int MAX_DISPLAY_WIDTH = 121;

    // private members
    private boolean rules[];  // allocate rules[8] in constructor!
    private String thisGen = "*";   // same here
    private String extremeBit = " "; // bit, "*" or " ", implied everywhere "outside"
    private int displayWidth;  // an odd number so it can be perfectly centered

    // public constructors, mutators, etc. (need to be written)
    public Automaton(int new_rule)
    {
        setDisplayWidth(81);
        if (!setRule(new_rule))
        {
            setRule(0); //sets the rule to a default 0 if the value is out of range
        }
        thisGen = extremeBit + extremeBit + thisGen + extremeBit + extremeBit;    

    }
    
    public void resetFirstGen()
    {
        extremeBit = " ";
        thisGen = "*";
    }
    
    public boolean setRule(int rule) 
    {   
        if (rule < 0 || rule > 255)
        {
            return false;
        }
        rules = new boolean[8];
        
        int n = rule;    
        String sb = "";
        while(n > 0)
        {                
            sb = ((n%2) == 0 ? "0" : "1") + sb;
            n = n/2;
        }
        while (sb.length() < 8)
        {
            sb = "0"+ sb;
        }

        for (int i = 0; i < sb.length(); i++)
        {
            rules[i] = (sb.charAt(i) == '1')?true:false;
        }
        return true;

    }
    
    public boolean setDisplayWidth(int width)
    {
      //checks that the width is odd and less than the max display width
        if (width%2 != 0 && width <= MAX_DISPLAY_WIDTH) 
        {
            displayWidth = width;
            return true;
        }
        else
        {
            System.out.println("Invalid Width: Please input an odd integer.");
            return false;
        }
    }

    public String toStringCurrentGen()
    {
        String mod_str = "";
        if (thisGen.length() >= displayWidth)
        {   
            //calculates the how much thisGen must be truncated
            mod_str = thisGen.substring((thisGen.length() - displayWidth)/2, (thisGen.length() + displayWidth)/2 );            
        }

        else 
        {
            mod_str = thisGen;
            while (mod_str.length() < displayWidth)
            {
                //adds padding to thisGen until it reaches the display width
                mod_str = " " + mod_str + " ";
            }
        }
        return mod_str;
    }

    public void propagateNewGeneration()
    {     
        String nextGen = new String();
        for (int i = 1; i < thisGen.length()-1; i++) 
        {
            //reads three characters at a times and converts to binary
            char left   = thisGen.charAt(i-1);
            char center    = thisGen.charAt(i);
            char right  = thisGen.charAt(i+1);
            //concatenates the characters to form a 3-bit string
            String s = "" + left + center + right; 
            String test = s.replace(" ", "0").replace("*", "1");
            int index = Integer.parseInt(test,2); //converts the string of 0's and 1's to a #0-7
            nextGen += (rules[7 -index] == true)?"*":" "; //adding a "*" or " " based on boolean rules[]
        }
        
        int rules_index = (extremeBit == "*")?7:0 ;
        extremeBit = " "; //default extremeBit value 
        
        if (rules[rules_index] == true) 
        {
            extremeBit = "*";
        }        
        nextGen =  extremeBit + extremeBit + nextGen + extremeBit + extremeBit; 
        thisGen = nextGen;
    }
    
}

/*  **********************************************CONSOLE OUTPUT*************************************************************************
 * 
Enter a rule (0-255): 4
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
                                        *                                        
ENTER -1 TO EXIT PROGRAM

Enter a rule (0-255): 126
                                        *                                        
                                       ***                                       
                                      ** **                                      
                                     *******                                     
                                    **     **                                    
                                   ****   ****                                   
                                  **  ** **  **                                  
                                 ***************                                 
                                **             **                                
                               ****           ****                               
                              **  **         **  **                              
                             ********       ********                             
                            **      **     **      **                            
                           ****    ****   ****    ****                           
                          **  **  **  ** **  **  **  **                          
                         *******************************                         
                        **                             **                        
                       ****                           ****                       
                      **  **                         **  **                      
                     ********                       ********                     
                    **      **                     **      **                    
                   ****    ****                   ****    ****                   
                  **  **  **  **                 **  **  **  **                  
                 ****************               ****************                 
                **              **             **              **                
               ****            ****           ****            ****               
              **  **          **  **         **  **          **  **              
             ********        ********       ********        ********             
            **      **      **      **     **      **      **      **            
           ****    ****    ****    ****   ****    ****    ****    ****           
          **  **  **  **  **  **  **  ** **  **  **  **  **  **  **  **          
         ***************************************************************         
        **                                                             **        
       ****                                                           ****       
      **  **                                                         **  **      
     ********                                                       ********     
    **      **                                                     **      **    
   ****    ****                                                   ****    ****   
  **  **  **  **                                                 **  **  **  **  
 ****************                                               **************** 
**              **                                             **              **
***            ****                                           ****            ***
  **          **  **                                         **  **          **  
*****        ********                                       ********        *****
    **      **      **                                     **      **      **    
   ****    ****    ****                                   ****    ****    ****   
  **  **  **  **  **  **                                 **  **  **  **  **  **  
*************************                               *************************
                        **                             **                        
                       ****                           ****                       
                      **  **                         **  **                      
                     ********                       ********                     
                    **      **                     **      **                    
                   ****    ****                   ****    ****                   
                  **  **  **  **                 **  **  **  **                  
*                ****************               ****************                *
**              **              **             **              **              **
***            ****            ****           ****            ****            ***
  **          **  **          **  **         **  **          **  **          **  
*****        ********        ********       ********        ********        *****
    **      **      **      **      **     **      **      **      **      **    
   ****    ****    ****    ****    ****   ****    ****    ****    ****    ****   
  **  **  **  **  **  **  **  **  **  ** **  **  **  **  **  **  **  **  **  **  
*********************************************************************************
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
*                                                                               *
**                                                                             **
***                                                                           ***
  **                                                                         **  
*****                                                                       *****
    **                                                                     **    
   ****                                                                   ****   
  **  **                                                                 **  **  
*********                                                               *********
        **                                                             **        
       ****                                                           ****       
      **  **                                                         **  **      
     ********                                                       ********     
ENTER -1 TO EXIT PROGRAM

Enter a rule (0-255): 130
                                        *                                        
                                     ***  **                                     
                                      *  *                                       
                                   ***  *   **                                   
                                    *  *   *                                     
                                 ***  *   *   **                                 
                                  *  *   *   *                                   
                               ***  *   *   *   **                               
                                *  *   *   *   *                                 
                             ***  *   *   *   *   **                             
                              *  *   *   *   *   *                               
                           ***  *   *   *   *   *   **                           
                            *  *   *   *   *   *   *                             
                         ***  *   *   *   *   *   *   **                         
                          *  *   *   *   *   *   *   *                           
                       ***  *   *   *   *   *   *   *   **                       
                        *  *   *   *   *   *   *   *   *                         
                     ***  *   *   *   *   *   *   *   *   **                     
                      *  *   *   *   *   *   *   *   *   *                       
                   ***  *   *   *   *   *   *   *   *   *   **                   
                    *  *   *   *   *   *   *   *   *   *   *                     
                 ***  *   *   *   *   *   *   *   *   *   *   **                 
                  *  *   *   *   *   *   *   *   *   *   *   *                   
               ***  *   *   *   *   *   *   *   *   *   *   *   **               
                *  *   *   *   *   *   *   *   *   *   *   *   *                 
             ***  *   *   *   *   *   *   *   *   *   *   *   *   **             
              *  *   *   *   *   *   *   *   *   *   *   *   *   *               
           ***  *   *   *   *   *   *   *   *   *   *   *   *   *   **           
            *  *   *   *   *   *   *   *   *   *   *   *   *   *   *             
         ***  *   *   *   *   *   *   *   *   *   *   *   *   *   *   **         
          *  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *           
       ***  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   **       
        *  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *         
     ***  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   **     
      *  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *       
   ***  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   **   
    *  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *     
 ***  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   ** 
  *  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
**  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
*  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 
  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *  
 *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   
*   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *
ENTER -1 TO EXIT PROGRAM

Enter a rule (0-255): 124
                                        *                                        
                                        **                                       
                                        ***                                      
                                        * **                                     
                                        *****                                    
                                        *   **                                   
                                        **  ***                                  
                                        *** * **                                 
                                        * *******                                
                                        ***     **                               
                                        * **    ***                              
                                        *****   * **                             
                                        *   **  *****                            
                                        **  *** *   **                           
                                        *** * ****  ***                          
                                        * *****  ** * **                         
                                        ***   ** ********                        
                                        * **  ****      **                       
                                        ***** *  **     ***                      
                                        *   **** ***    * **                     
                                        **  *  *** **   *****                    
                                        *** ** * *****  *   **                   
                                        * ********   ** **  ***                  
                                        ***      **  ****** * **                 
                                        * **     *** *    *******                
                                        *****    * ****   *     **               
                                        *   **   ***  **  **    ***              
                                        **  ***  * ** *** ***   * **             
                                        *** * ** ****** *** **  *****            
                                        * ********    *** ***** *   **           
                                        ***      **   * ***   ****  ***          
                                        * **     ***  *** **  *  ** * **         
                                        *****    * ** * ***** ** ********        
                                        *   **   ********   ******      **       
                                        **  ***  *      **  *    **     ***      
                                        *** * ** **     *** **   ***    * **     
                                        * **********    * *****  * **   *****    
                                        ***        **   ***   ** *****  *   **   
                                        * **       ***  * **  ****   ** **  ***  
                                        *****      * ** ***** *  **  ****** * ** 
                                        *   **     ******   **** *** *    *******
                                        **  ***    *    **  *  *** ****   *     *
                                        *** * **   **   *** ** * ***  **  **    *
                                        * *******  ***  * ******** ** *** ***   *
                                        ***     ** * ** ***      ****** *** **  *
                                        * **    ********* **     *    *** ***** *
                                        *****   *       *****    **   * ***   ***
                                        *   **  **      *   **   ***  *** **  *  
                                        **  *** ***     **  ***  * ** * ***** ** 
                                        *** * *** **    *** * ** ********   *****
                                        * ***** *****   * ********      **  *    
                                        ***   ***   **  ***      **     *** **   
                                        * **  * **  *** * **     ***    * *****  
                                        ***** ***** * *******    * **   ***   ** 
                                        *   ***   *****     **   *****  * **  ***
                                        **  * **  *   **    ***  *   ** ***** *  
                                        *** ***** **  ***   * ** **  ****   **** 
                                        * ***   ***** * **  ******** *  **  *  **
                                        *** **  *   ******* *      **** *** ** * 
                                        * ***** **  *     ****     *  *** *******
                                        ***   ***** **    *  **    ** * ***      
                                        * **  *   *****   ** ***   ****** **     
                                        ***** **  *   **  **** **  *    *****    
                                        *   ***** **  *** *  ***** **   *   **   
                                        **  *   ***** * **** *   *****  **  ***  
                                        *** **  *   *****  ****  *   ** *** * ** 
                                        * ***** **  *   ** *  ** **  **** *******
                                        ***   ***** **  ***** ****** *  ***      
                                        * **  *   ***** *   ***    **** * **     
                                        ***** **  *   ****  * **   *  *******    
                                        *   ***** **  *  ** *****  ** *     **   
                                        **  *   ***** ** ****   ** *****    ***  
                                        *** **  *   ******  **  ****   **   * ** 
                                        * ***** **  *    ** *** *  **  ***  *****
                                        ***   ***** **   **** **** *** * ** *    
                                        * **  *   *****  *  ***  *** *********   
                                        ***** **  *   ** ** * ** * ***       **  
                                        *   ***** **  ************** **      *** 
                                        **  *   ***** *            *****     * **
                                        *** **  *   ****           *   **    ****
                                        * ***** **  *  **          **  ***   *   
                                        ***   ***** ** ***         *** * **  **  
                                        * **  *   ****** **        * ******* *** 
                                        ***** **  *    *****       ***     *** **
                                        *   ***** **   *   **      * **    * *** 
                                        **  *   *****  **  ***     *****   *** **
                                        *** **  *   ** *** * **    *   **  * ****
                                        * ***** **  **** *******   **  *** ***   
                                        ***   ***** *  ***     **  *** * *** **  
                                        * **  *   **** * **    *** * ***** ***** 
                                        ***** **  *  *******   * *****   ***   **
                                        *   ***** ** *     **  ***   **  * **  * 
                                        **  *   *******    *** * **  *** ***** **
                                        *** **  *     **   * ******* * ***   ****
                                        * ***** **    ***  ***     ***** **  *   
                                        ***   *****   * ** * **    *   ***** **  
                                        * **  *   **  **********   **  *   ***** 
                                        ***** **  *** *        **  *** **  *   **
                                        *   ***** * ****       *** * ***** **  * 
                                        **  *   *****  **      * *****   ***** **
ENTER -1 TO EXIT PROGRAM

Enter a rule (0-255): b
INVALID: Try Again

Enter a rule (0-255): -1
                                        *                                        
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
                                                                                 
ENTER -1 TO EXIT PROGRAM

 * 
 * */